## OAuth 2.1 (MCP Authorization with Scalekit)
**Current MCP Approach**: MCP servers implement OAuth 2.1 per the MCP authorization specification, supporting discovery, authorization, and access phases with bearer access tokens validated by the server. The flow includes authorization code and client credentials grants, dynamic client registration, and scoped access checks. The server exposes OAuth Protected Resource Metadata for discovery and requires bearer tokens in the `Authorization` header. It logs interactions for auditing and highlights PKCE, strict redirect URI matching, short-lived tokens, and granular scopes as security upgrades. The implementation uses Scalekit to validate access tokens and returns `WWW-Authenticate` responses for unauthorized access. 【F:OAuth 2.1 for MCP Servers/README.md†L1-L90】【F:OAuth 2.1 for MCP Servers/auth.py†L1-L64】【F:OAuth 2.1 for MCP Servers/server.py†L1-L55】
**Implementation Notes**: OAuth client configuration is supplied via environment variables for Scalekit client ID/secret, authorization server metadata, and resource metadata. The middleware checks for `Bearer <token>` headers and validates tokens via Scalekit. The metadata endpoint advertises the authorization server, bearer methods, resource documentation, and supported scopes. 【F:OAuth 2.1 for MCP Servers/config.py†L1-L20】【F:OAuth 2.1 for MCP Servers/auth.py†L18-L64】【F:OAuth 2.1 for MCP Servers/server.py†L27-L48】

## API Key Authentication (Environment Variables + Interactive Prompts)
**Current MCP Approach**: Multiple tutorials use API keys for external services (OpenAI, Google Gemini, Mistral, AviationStack, Tavily, Serper). Keys are collected via `getpass` or `input`, then stored in environment variables for downstream SDKs; some scripts read from `os.getenv` defaults and prompt only when missing. This constitutes API-key-based authentication to third-party services rather than OAuth. 【F:LLM Evaluation/llm_arena_as_a_judge.py†L27-L41】【F:agent_orchestration_with_mistral_agents_api.py†L18-L35】【F:how to enable function calling in Mistral Agents.py†L18-L47】【F:smartwebagent_tavily_gemini_webintelligence_marktechpost2.py†L24-L50】【F:AI Agents Codes/supervisor_framework_crewai_gemini_marktechpost.py†L42-L63】
**Implementation Notes**: API keys are injected into environment variables (e.g., `OPENAI_API_KEY`, `GOOGLE_API_KEY`, `MISTRAL_API_KEY`, `TAVILY_API_KEY`, `SERPER_API_KEY`) at runtime using `getpass`/`input`, enabling SDKs to authenticate without hardcoding secrets. The SmartWebAgent sets env vars after prompting, and the Supervisor framework sets env vars directly from constructor inputs. 【F:LLM Evaluation/llm_arena_as_a_judge.py†L38-L41】【F:agent_orchestration_with_mistral_agents_api.py†L22-L35】【F:smartwebagent_tavily_gemini_webintelligence_marktechpost2.py†L24-L50】【F:AI Agents Codes/supervisor_framework_crewai_gemini_marktechpost.py†L42-L63】

## API Key Usage in MCP Tool Integrations (Alpha Vantage)
**Current MCP Approach**: The finance MCP server calls Alpha Vantage with an API key appended as a query parameter (`apikey`) for each request. The key is sourced from environment configuration. 【F:OAuth 2.1 for MCP Servers/finance.py†L11-L23】【F:OAuth 2.1 for MCP Servers/config.py†L6-L20】
**Implementation Notes**: The Alpha Vantage key is read from `ALPHA_VANTAGE_API_KEY` and inserted into request parameters alongside the function name; failures return `None`. This is a classic API-key-in-query authentication pattern. 【F:OAuth 2.1 for MCP Servers/finance.py†L11-L23】【F:OAuth 2.1 for MCP Servers/config.py†L6-L20】

## Secret/PII Redaction and Guardrail Policies (Non-Auth Security)
**Current MCP Approach**: A secure agent example applies secret and PII redaction, prompt-injection heuristics, allowlisted URL access, rate limiting, and tool gating. It audits outputs for secret leaks/PII, blocks unsafe URLs, and redacts known secret tokens before returning results. 【F:AI Agents Codes/secure_ai_agent_with_guardrails_marktechpost.py†L18-L146】
**Implementation Notes**: The policy engine detects forbidden keywords, enforces rate limits, redacts PII/secret tokens, and restricts tool usage to an allowlist. Postflight reviews redact outputs if risk is medium/high and re-audit. These patterns address secrets management and data-leak prevention. 【F:AI Agents Codes/secure_ai_agent_with_guardrails_marktechpost.py†L18-L146】

## Authenticate-Once Aggregator (Zapier/Rube)
**Current MCP Approach**: Not found in this repository.
**Implementation Notes**: No Zapier/Rube-style “authenticate once, reuse across tools” integrations appear in the scanned codebase.
